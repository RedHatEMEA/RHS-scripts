# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
lang en_US.UTF-8
keyboard us
network --onboot no --device eth0 --noipv4 --noipv6
rootpw  --iscrypted $6$kkp2nF1ACLZw99E.$3h/P79HxKLvjR0EQYVolep6mfR4Jid1BXojaPMEih7y4M0y7G8RDjTPjyEyHgJ1QUzDeeCRxgAq1BrY8z7n5G.
# System services
services --enabled="ntpd"

firewall --disabled
authconfig --enableshadow --passalgo=sha512
selinux --disabled
timezone --utc UTC
bootloader --location=mbr --driveorder=vda,vdb --append=" rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
#clearpart --linux --drives=vda
#volgroup VolGroup --pesize=4096 pv.253002
#logvol / --fstype=ext4 --name=lv_root --vgname=VolGroup --grow --size=1024 --maxsize=51200
#logvol swap --name=lv_swap --vgname=VolGroup --grow --size=2016 --maxsize=4032


#part /boot --fstype=ext4 --size=500
#part pv.253002 --grow --size=1



%packages --nobase
@Core
@core
@glusterfs-swift
@rhs-tools
@scalable-file-systems
glusterfs
glusterfs-fuse
glusterfs-geo-replication
glusterfs-rdma
glusterfs-server
mdadm
tuned
tuned-utils
xfsdump
xfsprogs

%end

%post --nochroot
## bz 796193
for f in /mnt/sysimage/etc/sysconfig/network-scripts/ifcfg-*; do
    if echo $f | grep -q 'ifcfg-lo$'; then
        continue
    fi
    if ! grep -q '^BOOTPROTO' $f; then
        echo 'BOOTPROTO="dhcp"' >> $f
    fi
    if grep -q '^ONBOOT' $f; then
        sed -i -e '/^ONBOOT/c ONBOOT="yes"' $f
    else
        echo 'ONBOOT="yes"' >> $f
    fi
done

# bz 798597
sed -i -e '/^Red Hat Enterprise Linux/c Red Hat Storage release 2.0 for On-Premise' /mnt/sysimage/etc/issue /mnt/sysimage/etc/issue.net
%end

%post
# for some reason selinux --disabled in the ks doesn't work? huh?
sed -i -e 's/\(^SELINUX=\).*$/\1disabled/' /etc/selinux/config

#/usr/sbin/fix-grub.sh
%end
